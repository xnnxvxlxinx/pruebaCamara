<!DOCTYPE HTML>
<html>
<head>
    <title>Inicio de Sesi&oacute;n</title>
     <meta
  name="viewport"
  content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
   
	<link rel="stylesheet" type="text/css" href="../archivosbase/CSS/cabeza.css">
    <link rel="stylesheet" type="text/css" href="../archivosbase/CSS/iniciosesion.css">
	<link rel="stylesheet" type="text/css" href="../archivosbase/CSS/publicacionServicios.css">
	<link rel="stylesheet" type="text/css" href="../archivosbase/CSS/fotosseleccion.css">
	<link rel="stylesheet" type="text/css" href="../archivosbase/CSS/ajax-loader.css">
	<link rel="stylesheet" type="text/css" href="../archivosbase/CSS/mensaje_javascript.css">
    <link rel="shortcut icon" href="../archivosbase/icons/favicon.ico" />
	<script src="../archivosbase/jquerymobile145/jquery-3.2.1.min.js"></script>
 <script src="../archivosbase/jquerymobile145/jquery.mobile-1.4.5.min.js"></script>
 <script type="text/javascript" src="../cordova.js"></script>
	<script>

    
	var TagPrinciForm=0;
	var InputTitulo='';
var InputDescripcion='';
var InputTagSecundario=[];
	function initialize() {
	
	$.get("../archivosbase/cabeza.html", function(htmlexterno){
   $("#cabecera").html(htmlexterno);
    	});
		
		tagPrincipal();
		}
/*Funcion Cerrar*/
function cerrar(div){		
$("#" + div).fadeOut(150);
}
		var numeroTagsPrin=0;
function tagPrincipal(){

document.getElementById('ajax-loader').style.display='block';
setTimeout(function(){

	document.getElementById('seleccionadorTags').innerHTML='';
	var numeroTagsPrin=0;
	TagPrinciForm=0;
	 InputTitulo='';
 InputDescripcion='';
 InputTagSecundario=[];
	   $.getJSON('https://nirjob.com/PhoneGap/servicios/TagPrincipales.php', function(data) {  
  
		var tamanio=data.length;
			for(var i=0; i<tamanio; i++){
				var ID=data[i].ID;
				var Nombre=data[i].Nombre;
				var Imagen=data[i].Imagen;
			mostrarTags(ID, Nombre, Imagen);
			}
		document.getElementById('ajax-loader').style.display='none';	
		});	

		}, 150);
} 
function ObtenerTagSecundario(ID){
document.getElementById('ajax-loader').style.display='block';
setTimeout(function(){
	   $.getJSON('https://nirjob.com/PhoneGap/servicios/TagSecundarios.php' + '?ID=' + ID, function(data) {  
	var texto='<div><h3>Sub Categorías.</h3>';
		var tamanio=data.length;
			for(var i=0; i<tamanio; i++){
				var ID=data[i].ID;
				var Nombre=data[i].Nombre;
				texto=texto + "<label>"+ Nombre +": <input type='checkbox' value='"+ ID +"' class='InputTagSecundario'/></label>";
			}
			texto=texto + "<input type='submit' value='Siguiente' onclick='seleccionadorImagenes();' style='background-color: #FFD54F;'></div>";
		document.getElementById('seleccionadorTagsSecundarioC').innerHTML=texto;
		document.getElementById('ajax-loader').style.display='none';	
		});	
		}, 150);
}
function mostrarTags(ID, Nombre, Imagen){
var div=document.getElementById('seleccionadorTags');
var indiv = document.createElement('div');
		indiv.id='seleccionadorTags_' + numeroTagsPrin;
		var texto='<div  onclick="seleccionadorTitulo(\''+ ID +'\')"><img src="https://nirjob.com/'+ Imagen +'" style="background-color:#1c8ee6;border-radius: 20px;"/>';
		 texto= texto + '<h3>'+ Nombre +'</h3></div>';
		div.appendChild(indiv);
		document.getElementById('seleccionadorTags_' + numeroTagsPrin).innerHTML=texto;
		numeroTagsPrin=numeroTagsPrin+1;
}

function mostrarTitulo(){

var div=document.getElementById('seleccionadorTituloC');

		var texto='<div ><h3>Título de la Publicación.</h3><input type="text" id="InputTitulo" value="'+ InputTitulo +'" /></br>';
		 texto= texto + '<h3>Descripción de la Publicación.</h3><input type="text" id="InputDescripcion" value="' + InputDescripcion +'" /></br>';
		 texto=texto +'<input type="submit" value="Siguiente" onclick="seleccionadorTagsSecundario();" style="background-color: #FFD54F;"></div>';
		
		div.innerHTML=texto;
}
var numeroImagenes=0;
function ObtenerImagenes(){
var div=document.getElementById('seleccionadorImagenesC');
var indiv = document.createElement('div');
		indiv.id='seleccionadorImagenesC_' + numeroImagenes;
		var texto='';
		 texto= texto + '<div class="seleccionadorImagenesC_foto" >';
		 texto= texto + '<img onclick="seleccionFotoImagenI(this)" style="max-width:100%; max-height:5em;"/></div>';
		div.appendChild(indiv);
		document.getElementById('seleccionadorImagenesC_' + numeroImagenes).innerHTML=texto;
		numeroImagenes=numeroImagenes+1;
}
var fotoImagen='';
function seleccionFotoImagenI(e){
fotoImagen=e.src;
var mensaje=document.getElementById('mensaje_javascript');
		mensaje.style.display='block';
var texto="<p>¿Desea usar la cámara u obtener foto de la galería?</p>";
texto= texto + "<button type='button' onclick='seleccionFotoImagen(1); cerrar(\"mensaje_javascript\");'>Camara</button>";
texto= texto + "<button type='button' onclick='seleccionFotoImagen(2); cerrar(\"mensaje_javascript\");'>Galeria</button>";
		mensaje.childNodes[0].innerHTML=texto;
	}
function seleccionFotoImagen(Num){
if(Num==1){
navigator.camera.getPicture(correcto, error, { quality: 200, destinationType: Camera.DestinationType.FILE_URI });
}else{
getPhoto(pictureSource.PHOTOLIBRARY);
}
}
function getPhoto(source) {
      // Retrieve image file location from specified source
      navigator.camera.getPicture(correcto, error, { quality: 200, 
        destinationType: destinationType.FILE_URI,
        sourceType: source });
    }
function correcto(rutaImagen){
console.log(JSON.stringify(rutaImagen));
fotoImagen=rutaImagen;
ObtenerImagenes();
}
function error(mensaje){
alert(mensaje);
}
function seleccionadorTagsSecundario(){
InputTitulo=document.getElementById('InputTitulo').value;
InputDescripcion=document.getElementById('InputDescripcion').value;
if(InputTitulo!='' && InputDescripcion!=''){
$("#seleccionadorTitulo").fadeOut(250);
document.getElementById('ajax-loader').style.display='block';
setTimeout(function(){

document.getElementById('seleccionadorTagsSecundarioC').innerHTML='';
ObtenerTagSecundario(TagPrinciForm);
document.getElementById('ajax-loader').style.display='none';	
$("#seleccionadorTagsSecundario").fadeIn(250);
}, 255);
}else{
var mensaje=document.getElementById('mensaje_javascript');
		mensaje.style.display='block';
var texto="<p>La publicación debe tener un título y una descripción.</p>";
texto= texto + "<button type='button' onclick='cerrar(\"mensaje_javascript\")'>Aceptar</button>";
		mensaje.childNodes[0].innerHTML=texto;
}
}
function seleccionadorImagenes(){
var C=document.getElementsByClassName('InputTagSecundario');
var aux=0;
for(var i=0; i<C.length; C++){
if(C[i].checked==true){
InputTagSecundario[aux]=C[i].value;
aux=aux+1;
}
}
if(aux!=0){
$("#seleccionadorTagsSecundario").fadeOut(250);
document.getElementById('ajax-loader').style.display='block';
setTimeout(function(){
document.getElementById('seleccionadorImagenesC').innerHTML='';
ObtenerImagenes();
document.getElementById('ajax-loader').style.display='none';	
$("#seleccionadorImagenes").fadeIn(250);
}, 255); }else{
var mensaje=document.getElementById('mensaje_javascript');
		mensaje.style.display='block';
var texto="<p>No ha seleccionado ninguna sub categoría.</p>";
texto= texto + "<button type='button' onclick='cerrar(\"mensaje_javascript\")'>Aceptar</button>";
		mensaje.childNodes[0].innerHTML=texto;
}
}
function seleccionadorTitulo(ID){

$("#seleccionadorTags").fadeOut(250);
document.getElementById('ajax-loader').style.display='block';
setTimeout(function(){
TagPrinciForm=ID;
document.getElementById('seleccionadorTituloC').innerHTML='';
mostrarTitulo();
document.getElementById('ajax-loader').style.display='none';	
$("#seleccionadorTitulo").fadeIn(250);
}, 255);
}
function regresar(num){
if(num==1){
$("#seleccionadorTitulo").fadeOut(250);
tagPrincipal();
setTimeout(function(){

$("#seleccionadorTags").fadeIn(250);
}, 255);
}
if(num==2){
$("#seleccionadorTagsSecundario").fadeOut(250);
mostrarTitulo();
setTimeout(function(){

$("#seleccionadorTitulo").fadeIn(250);
}, 255);
}
if(num==3){
$("#seleccionadorImagenes").fadeOut(250);
ObtenerTagSecundario(TagPrinciForm);
setTimeout(function(){

$("#seleccionadorTagsSecundario").fadeIn(250);
}, 255);
}
}
/*$(function(){
        $("#formuploadajaxTag").on("submit", function(e){
			
            e.preventDefault();
            var f = $(this);
            var formData = new FormData(document.getElementById("formuploadajaxTag"));
			document.getElementById('ajax-loader').style.display='block';
			setTimeout(function(){
            $.ajax({
                url: "https://nirjob.com/PhoneGap/login.php",
                type: "post",
                dataType: "json",
                data: formData,
                cache: false,
                contentType: false,
	     processData: false
            }).done(function(data){
				var tamanio=data.length;
				if(data[0].SesionError=='0' && tamanio==1){
				var SesionID=data[0].SesionID;	
				var SesionNivel=data[0].SesionNivel;
				var SesionNombre=data[0].SesionNombre;
				var SesionDireccion=data[0].SesionDireccion;
				var SesionMail=data[0].SesionMail;
				var SesionTelefono=data[0].SesionTelefono;
				var SesionLoggedin=data[0].SesionLoggedin;
				var SesionUsuario=data[0].SesionUsuario;
				localStorage.setItem("SesionID", SesionID);
				localStorage.setItem("SesionNivel", SesionNivel);
				localStorage.setItem("SesionNombre", SesionNombre);
				localStorage.setItem("SesionDireccion", SesionDireccion);
				localStorage.setItem("SesionMail", SesionMail);
				localStorage.setItem("SesionTelefono", SesionTelefono);
				localStorage.setItem("SesionLoggedin", SesionLoggedin);
				localStorage.setItem("SesionUsuario", SesionUsuario);
				location.href="../index.html";
				$("#ErrorInicio").html("");
				}else{
				if(data[0].SesionError=='1'){
				$("#ErrorInicio").html("Error");
				}
				if(data[0].SesionError=='2'){
				$("#ErrorInicio").html("El nombre de usuario o la contraseña están incorrectos.");
				}
				if(data[0].SesionError=='3'){
				$("#ErrorInicio").html("El nombre de usuario o la contraseña están incorrectos.");
				}
				if(data[0].SesionError=='4'){
				$("#ErrorInicio").html("Error 404");
				}
				}
			document.getElementById('ajax-loader').style.display='none';
                });
				
				}, 250);
        
		});
		});*/
 		
	</script>
</head>
<body onload='initialize();'>
    <div id="container">
        <div id="cabecera">

        </div>
		<div id='contenido'>
		<div class='limpiador'></div>
		<div id='seleccionadorTags'>
		
		</div>
		<div class='limpiador'></div>
		<div id='seleccionadorTitulo' style='display:none'>
		<div id='seleccionadorTituloBRegresar' >
		<input type="submit" value="Regresar" onclick='regresar(1);' style="background-color: #FFD54F;">
		</div>
		<div id='seleccionadorTituloC' >
		</div>
		</div>
		<div id='seleccionadorTagsSecundario' style='display:none'>
		<div id='seleccionadorTagsSecundarioBRegresar' >
		<input type="submit" value="Regresar" onclick='regresar(2);' style="background-color: #FFD54F;">
		</div>
		<div id='seleccionadorTagsSecundarioC' >
		</div>
		</div>
		<div id='seleccionadorImagenes' style='display:none'>
		<div id='seleccionadorImagenesBRegresar' >
		<input type="submit" value="Regresar" onclick='regresar(3);' style="background-color: #FFD54F;">
		</div>
		<div id='seleccionadorImagenesC' >
		</div>
		</div>
	<!--	<div id='form_inicio_sesion' class='form_inicio'>
<div id='ErrorInicio'></div>
    <div class="login">
<form method="post" id='formuploadajaxTag' name="f1">	
<label for="username"><div class="textLabel">Usuario</div></label>
<input type="text" name="username" id="username" required placeholder="">
<br/>
<label for="userPwd"><div class="textLabel">Contrase&ntilde;a</div></label>
<input type="password" name="password" id="userPwd" required placeholder="">
<br/>
<input type="submit" name="Submit" value="Entrar">

</form>
<br/>
<div id="aunnocuenta">

<form action="registro.php" method="POST">
    <input type="submit" value="Registrarse" style="background-color: #FFD54F;">
</form>
</div>
</div>
		</div>-->
		</div>
		<div id='footer'>

		</div>
		<div id='ajax-loader'>
	<img src='../archivosbase/img/ajax-loader.gif'/>
	</div>
	<div id='mensaje_javascript'><div></div></div>
    </div>
    </div>
</body>
</html>

